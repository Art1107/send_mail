# SendGrid Webhook Event Handler

## р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
р╕гр╕░р╕Ър╕Ър╕гр╕▒р╕Ър╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕г webhook events р╕Ир╕▓р╕Б SendGrid р╕Юр╕гр╣Йр╕нр╕бр╕Чр╕▒р╣Йр╕Зр╕кр╣Ир╕Зр╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Ьр╣Ир╕▓р╕Щ Lark р╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕кр╕│р╕Др╕▒р╕Н

### р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤р╕лр╕ер╕▒р╕Б
- р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕гр╕▒р╕Ъ webhook events р╕Ир╕▓р╕Б SendGrid
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щ (signature verification)
- р╕Ър╕▒р╕Щр╕Чр╕╢р╕Б logs р╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Др╕Яр╕ер╣Мр╣Бр╕ер╕░ CSV
- р╕кр╣Ир╕Зр╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Ьр╣Ир╕▓р╕Щ Lark webhook р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕кр╕│р╕Др╕▒р╕Н
- р╕гр╕нр╕Зр╕гр╕▒р╕Ър╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣Мр╕лр╕ер╕▒р╕Б: delivered, open, click, bounce, spam_report

###  р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З
1. Clone repository:
```bash
git clone <repository-url>
```

2. р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З dependencies:
```bash
go mod download
```

3. р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env р╣Бр╕ер╕░р╕Бр╕│р╕лр╕Щр╕Фр╕Др╣Ир╕▓р╕Хр╣Ир╕▓р╕Зр╣Ж:
```env
SENDGRID_PUBLIC_KEY="your-public-key"
SERVER_PORT=":8080"
LARK_WEBHOOK_URL="your-lark-webhook-url"
LOG_FILE="sendgrid_events.log"
```

### р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
1. р╕гр╕▒р╕Щр╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М:
```bash
go run cmd/main.go
```

2. р╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣Мр╕Ир╕░р╣Ар╕гр╕┤р╣Ир╕бр╕Чр╕│р╕Зр╕▓р╕Щр╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Х 8080 (р╕лр╕гр╕╖р╕нр╕Хр╕▓р╕бр╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Фр╣Гр╕Щ .env)

3. Endpoints:
- `/webhook` - р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▒р╕Ъ SendGrid events
- `/test` - р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ

### р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д
```
send_mail/
тФЬтФАтФА cmd/
тФВ   тФФтФАтФА main.go                 # р╕Ир╕╕р╕Фр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕б
тФЬтФАтФА internal/
тФВ   тФЬтФАтФА adapters/
тФВ   тФВ   тФФтФАтФА lark/              # р╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ Lark
тФВ   тФЬтФАтФА core/                  # р╕Ър╕┤р╕кр╣Ар╕Щр╕кр╕ер╕нр╕Ир╕┤р╕Бр╕лр╕ер╕▒р╕Б
тФВ   тФЬтФАтФА domain/               # р╣Вр╕бр╣Ар╕Фр╕ер╣Бр╕ер╕░ errors
тФВ   тФФтФАтФА ports/                # interfaces
тФЬтФАтФА pkg/
тФВ   тФЬтФАтФА logger/               # р╕гр╕░р╕Ър╕Ър╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╣Зр╕нр╕Б
тФВ   тФФтФАтФА verify/               # р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щ
тФФтФАтФА config/                   # р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ
```

### р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
- р╕гр╕░р╕Ър╕Ър╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕ер╕▓р╕вр╣Ар╕Лр╣Зр╕Щр╕Вр╕нр╕З SendGrid
- р╕Хр╣Йр╕нр╕Зр╕Бр╕│р╕лр╕Щр╕Ф SENDGRID_PUBLIC_KEY р╣Гр╕Щ .env file
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ HTTPS (р╕Др╕зр╕гр╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕г deploy)

### ЁЯУЭ р╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е
- р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕ер╣Зр╕нр╕Бр╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Др╕Яр╕ер╣Мр╕Ыр╕Бр╕Хр╕┤р╣Бр╕ер╕░ CSV
- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Б: timestamp, р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕кр╕│р╕Др╕▒р╕Н, р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б, р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М, р╕нр╕╡р╣Ар╕бр╕е, р╣Ар╕зр╕ер╕▓р╕Вр╕нр╕Зр╣Ар╕лр╕Хр╕╕р╕Бр╕▓р╕гр╕Ур╣М

### р╕лр╕▓р╕Бр╕Юр╕Ър╕Ыр╕▒р╕Нр╕лр╕▓р╕лр╕гр╕╖р╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Гр╕лр╕бр╣И р╕Бр╕гр╕╕р╕Ур╕▓р╕кр╕гр╣Йр╕▓р╕З issue р╣Гр╕Щ repository
